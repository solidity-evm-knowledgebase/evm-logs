# evm-logs

## What are EVM Logs?

EVM Logs are data structures generated by the Ethereum Virtual Machine (EVM) during transaction execution. They allow smart contracts to emit events, which can be captured by off-chain applications. Logs are stored in the transaction receipts and are not part of the contract's state, making them cost-effective for storing event-related data.

### Key Characteristics:

- **Not Accessible On-chain**: Logs cannot be accessed by smart contracts during execution.
- **Stored in Receipts**: They are part of transaction receipts, not the blockchain state.
- **Efficient for Events**: Ideal for emitting events without modifying contract storage.

## Structure of Event Logs:

An Event Log consists of several components that collectively represent an event emitted by a smart contract.

Each log entry contains the following fields:
- `address`: The 20-byte address of the contract that generated the log; It identifies the contract emitting the log.
- `topics`:  An array of up to 4 `32-byte` topics, used for indexing and filtering. (Topic0 being essentially a Keccak256 hash of the event signature, composed of the event's name and its input parameters' types); Act as indexed parameters for the log, facilitating efficient filtering. 
- `data`: A chunk of binary data of arbitrary size; Contains the non-indexed parameters, holding the event's actual data.

## Generating Event Logs

Logs are generated during contract execution using specific opcodes or high-level language constructs.

### The LOG Opcodes

EVM provides opcodes for generating logs:
- `LOG0` to `LOG4`: Opcodes ranging from `0xa0` to `0xa4`, where the number indicates how many topics are included (from 0 to 4).

Usage:
- **Stack Operations**: The opcodes consume data and topics from the stack.
- **Dynamic Data Size**: Allows for variable-length data payloads.

## Solidity Events

In Solidity, logs are typically generated using the event keyword.

**Defining Events**:

```solidity
pragma solidity ^0.8.0;

contract Example {
    event Transfer(address indexed from, address indexed to, uint256 value);

    function transfer(address to, uint256 value) public {
        // Emit the event
        emit Transfer(msg.sender, to, value);
    }
}
```

- **Indexed Parameters**: Marked with `indexed`, stored in `topics`.
- **Non-Indexed Parameters**: Stored in the `data` field.


